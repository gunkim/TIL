# 컴퓨터 시스템의 구성

<center>
    <img src="computer-system.png">
</center>

현대 범용 컴퓨터 시스템은 시스템 버스를 통해 CPU, 입출력 장치(키보드, 마우스, 모니터 등), 메모리 등이 연결된다.

일반적으로 운영체제에는 각 장치 컨트롤러마다 **장치 드라이버**가 있다. 이 장치 드라이버는 장치 컨트롤러의 작동을 잘 알고 있고 나머지 운영체제에 장치에 대한 일관된 인터페이스를 제공한다. 

CPU와 장치 컨트롤러는 병렬로 실행되어 메모리 사이클을 놓고 경쟁한다. 공유 메모리를 질서 있게 액세스하기 위해 메모리 컨트롤러는 메모리에 대한 액세스를 동기화한다.

## 인터럽트

1. 장치 드라이버는 I/O 작업을 시작하기 위해 장치 컨트롤러의 레지스터에 값을 할당한다. 
2. 장치 컨트롤러는 이 값을 바탕으로 어떤 작업을 수행할지 결정한다. 
3. 작업을 결정한 후에는 장치에서 로컬 버퍼로 데이터를 전송한다. 
4. 작업이 끝나면, 장치컨트롤러는 **인터럽트**를 통해 드라이버에게 작업 완료를 알린다.

### 개요

하드웨어는 시스템 버스를 통해 CPU에 신호를 보내 인터럽트를 발생시킬 수 있다.

<center>
    <img src="interrupts.png">
</center>

1. CPU가 인터럽트 되면 CPU는 하던 일을 중단하고 즉시 고정된 위치로 실행을 옮긴다.
2. 이러한 고정된 위치는 일반적으로 인터럽트를 위한 서비스 루틴이 위치한 시작 주소를 가지고 있다.
3. 그리고 인터럽트 서비스 루틴이 실행된다. 
4. 인터럽트 서비스 루틴의 실행이 완료되면 CPU는 인터럽트 되었던 연산을 재개한다.

인터럽트는 빠르게 처리되어야 하며, 이를 위해 인터럽트 루틴에 대한 포인터 테이블(인터럽트 벡터)이 사용된다. 이 테이블은 인터럽트를 발생시킨 장치에 맞는 서비스 루틴을 바로 호출하게 해준다. 인터럽트가 발생하면 CPU가 원래 하던 작업의 상태가 저장되고, 인터럽트 처리 후에 원래의 상태로 복원된다. 이 과정은 인터럽트가 발생하지 않았던 것처럼 연산이 이어지도록 해준다.
